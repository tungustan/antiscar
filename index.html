<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Fullscreen Bunny Player</title>
<style>
body { margin:0; background:black; color:white; text-align:center; font-family:Arial; }
#loginBox { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); }
#videoSection { display:none; }
video { width:100%; height:100vh; object-fit:contain; background:black; }
button { padding:12px 25px; font-size:18px; margin-top:15px; cursor:pointer; }
</style>
</head>
<body>

<div id="loginBox">
<h2>ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h2>
<input type="password" id="pw">
<br>
<button onclick="checkPassword()">ì ‘ì†</button>
<p id="error" style="color:red;"></p>
</div>

<div id="videoSection">
<button onclick="startPlayback()">â–¶ ì¬ìƒ ì‹œì‘ (ì „ì²´í™”ë©´)</button>
<div id="title"></div>
<video id="player" controls></video>
</div>

<script>
const correctPassword = "12345";
const libraryId = "603895";
const apiKey = "YOUR_NEW_API_KEY";
const pullZoneUrl = "https://vz-af7f48b7-cd1.b-cdn.net";

let videos = [];
let currentIndex = 0;
const player = document.getElementById("player");
const titleDiv = document.getElementById("title");

function checkPassword(){
  if(document.getElementById("pw").value === correctPassword){
    document.getElementById("loginBox").style.display="none";
    document.getElementById("videoSection").style.display="block";
    loadVideos();
  } else {
    document.getElementById("error").innerText="ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼";
  }
}

async function loadVideos(){
  try{
    const res = await fetch(`https://video.bunnycdn.com/library/${libraryId}/videos?page=1&itemsPerPage=100`,{
      headers:{ "AccessKey": apiKey }
    });
    const data = await res.json();
    videos = data.items || [];
    videos.sort((a,b)=>(a.title||"").localeCompare(b.title||"",'ko'));
  }catch(e){
    alert("API ì˜¤ë¥˜ (CORS ë˜ëŠ” í‚¤ ë¬¸ì œ)");
    console.error(e);
  }
}

function enterFullscreen(element){
  if(element.requestFullscreen){
    element.requestFullscreen();
  }else if(element.webkitRequestFullscreen){
    element.webkitRequestFullscreen();
  }else if(element.msRequestFullscreen){
    element.msRequestFullscreen();
  }
}

function startPlayback(){
  if(!videos.length){
    alert("ì˜ìƒ ì—†ìŒ");
    return;
  }

  enterFullscreen(document.documentElement); // ğŸ”¥ í˜ì´ì§€ ì „ì²´í™”ë©´

  playVideo(0);
}

function playVideo(i){
  currentIndex=i;
  const v=videos[i];
  player.src=`${pullZoneUrl}/${v.guid}/play_720p.mp4`;
  titleDiv.innerText=v.title;
  player.play();
}

player.addEventListener("ended",()=>{
  if(currentIndex+1 < videos.length){
    playVideo(currentIndex+1);
  }else{
    titleDiv.innerText="ëª¨ë“  ì˜ìƒ ì¬ìƒ ì™„ë£Œ";
  }
});
</script>

</body>
</html>
